/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */

/**
 * Adapted from the official plugin text.js
 *
 * Uses UnderscoreJS micro-templates : http://documentcloud.github.com/underscore/#template
 * @author Julien Caban√®s <julien@zeeagency.com>
 * @version 0.2
 * 
 * @license RequireJS text 0.24.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/*! Hammer.JS - v1.0.6 - 2014-01-02
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */

/*! overthrow - An overflow:auto polyfill for responsive design. - v0.7.0 - 2013-11-04
* Copyright (c) 2013 Scott Jehl, Filament Group, Inc.; Licensed MIT */

/*! Overthrow. An overflow:auto polyfill for responsive design. (c) 2012: Scott Jehl, Filament Group, Inc. http://filamentgroup.github.com/Overthrow/license.txt */

define("main/modules/utils/dev",[],function(){return{log:function(){typeof window.console=="object"&&window.console.log(Array.prototype.slice.call(arguments))}}}),define("main/modules/utils/number",["jquery","underscore"],function(e,t){return{parseDecimalInt:function(e){return parseInt(e,10)},numberFormat:function(e,t,n,r){if(isNaN(e)||e===null)return"";e=e.toFixed(t),r=typeof r=="string"?r:",";var i=e.split("."),s=i[0],o=i[1]?(n||".")+i[1]:"";return s.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+r)+o},formatPrice:function(e,n){t.extend({decimals:2,decimalSeparator:",",orderSeparator:" "},n);var r=this.numberFormat(e,n.decimals,n.decimalSeparator,n.orderSeparator);return r+" "+n.currency}}}),define("main/modules/utils/visual",["jquery","underscore"],function(e,t){return{newHelpActivatedCountries:["allegro.pl","vatera.hu","aukro.ua","molotok.ru","aukro.cz"],newHelpUrls:{"allegro.pl":"pomoc.allegro.pl","vatera.hu":"segitseg.vatera.hu","aukro.ua":"help.aukro.ua","molotok.ru":"help.molotok.ru","aukro.cz":"napoveda.aukro.cz"},canShowExternalHelp:function(){return t.contains(this.newHelpActivatedCountries,this.getDomainName())},openHelp:function(e){if(this.canShowExternalHelp())e!==undefined?window.open("http://"+this.newHelpUrls[this.getDomainName()]+"/help_item/"+e,"_blank"):window.open("http://"+this.newHelpUrls[this.getDomainName()],"_blank");else{var t,n="height=400,width=450,toolbar=no,menubar=no,scrollbars=yes,resizable=yes,location=no,directories=no,status=no";e!==undefined?t=window.open("/help_item.php?item="+e,"anew",n):t=window.open("/help.php?","anew",n),t.closed||t.focus()}},scrollTo:function(t,n,r){e("html, body").animate({scrollTop:e(t).offset().top+(r||0)},n||500)},getDomainName:function(){var t=e("body").attr("class").split(" ");return t[0].replace("-",".")}}}),define("main/utils",["main/modules/utils/dev","main/modules/utils/number","main/modules/utils/visual"],function(e,t,n){return{dev:e,number:t,visual:n}}),define("velalayout/openHelp",["jquery","main/utils"],function(e,t){return{initialize:function(){e("a.open-help").on("click",function(n){var r;e(this).data("help-item")!==undefined&&(r=e(this).data("help-item")),t.visual.openHelp(r),n.preventDefault()})}}}),define("search/auto-complete/models/history",["backbone"],function(e){var t=e.Model.extend({initialize:function(){this.set("id",this.cid),this.set("text",this.mask(this.get("text")))},defaults:{phrase:"",text:"",type:3,match:!1},mask:function(e){return e.replace(/^\s+|\s+$/g,"").replace(/\s\s+/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;")}});return t}),define("search/auto-complete/collections/history",["jquery","backbone","underscore","search/auto-complete/models/history"],function(e,t,n,r){var i=t.Collection.extend({model:r,initialize:function(e,t){this.config=t,this.history=this.load(),this.queryValue="",this.on("reset",this.dataReceived,this),this.on("add",this.sync,this),this.on("remove",this.sync,this)},dataReceived:function(){this.trigger("dataReceived",{historyReceived:!0})},add:function(e,i){e=e instanceof Array?e:[e],n.each(e,function(e){e=e instanceof t.Model?e:new r(e),e.get("text")!==""&&(this.each(function(t){t.get("text")===e.get("text")&&this.remove(t,{silent:!0})},this),t.Collection.prototype.add.call(this,e,i))},this)},sync:function(){this.history=[],this.each(function(e,t){this.history[this.history.length]=e.get("text")},this),window.localStorage.setItem(this.config.storage,this.history.length?JSON.stringify(this.history):"[]")},load:function(){var t=[];return window.localStorage.getItem(this.config.storage)&&(t=e.parseJSON(window.localStorage.getItem(this.config.storage))),t},parseHistory:function(){var e=this.queryValue,t=[];return e=e.replace(/ /g,"</strong> <strong>"),n.each(this.history,function(n,i){var s=this.queryRegExp(this.queryValue),o=(" "+n).replace(s," <strong>"+e+"</strong>").substr(1),u=(" "+n).match(s)?!0:!1,a;a=new r({phrase:o,text:n,match:u}),t[t.length]=a},this),t[0]?t:[]},query:function(e){this.queryValue=e,this.reset(this.parseHistory())},queryRegExp:function(e){return e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),new RegExp("\\s"+e,"gi")}});return i}),define("search/auto-complete/collections/suggestions",["jquery","backbone","underscore"],function(e,t,n){var r=t.Collection.extend({initialize:function(e,t){this.config=t,this.queryValue="",this.on("reset",this.dataReceived,this)},dataReceived:function(){this.trigger("dataReceived",{suggestionsReceived:!0})},parse:function(t){var r=[];return n.each(t,function(t,n){r[r.length]=e.parseJSON(t)}),r[0]?r:[]},query:function(e){this.queryValue!==e?(this.queryValue=e,this.url=this.config.url+"?q="+e,this.fetch({reset:!0})):this.trigger("reset")}});return r}),define("search/auto-complete/collections/auto-complete",["jquery","backbone","underscore","search/auto-complete/collections/history","search/auto-complete/collections/suggestions"],function(e,t,n,r,i){var s=t.Collection.extend({initialize:function(e,t){this.init=!0,this.historyReceived=!1,this.suggestionsReceived=!1,this.config=t,this.queryValue="",this.history=new r([],{storage:t.storage}),this.suggestions=new i([],{url:t.url}),this.history.on("dataReceived",this.dataReceived,this),this.suggestions.on("dataReceived",this.dataReceived,this)},addItem:function(e,t){this.history.add(e,t)},removeItem:function(e){this.history.remove(e),this.trigger("removeItem")},query:function(e){e=this.trim(e),this.history.query(e),this.suggestions.query(e)},dataReceived:function(e){e.historyReceived&&(this.historyReceived=!0),e.suggestionsReceived&&(this.suggestionsReceived=!0),this.historyReceived&&this.suggestionsReceived&&(this.merge(),this.historyReceived=!1,this.suggestionsReceived=!1)},merge:function(){var e=[],t=[],r=[],i;this.history.each(function(t){t.get("match")&&(e[e.length]=t.toJSON(),r[r.length]=t.get("phrase"))}),this.suggestions.each(function(e){var i=n.indexOf(r,e.get("phrase"))>-1&&e.get("type")===1,s=n.indexOf(r,e.get("phrase"))>=this.config.historyMatchLimit;if(!i||s)t[t.length]=e.toJSON()},this),i=Math.max(this.config.historyMatchLimit,this.config.totalMatchLimit-t.length),e=e.slice(0,i),t=t.slice(0,this.config.totalMatchLimit-e.length),this.reset(e.concat(t)),this.init&&(this.trigger("hide"),this.init=!1)},trim:function(e){return e=e.replace(/^\s+|\s+$/g,""),e=e.replace(/\s\s+/g," "),e}});return s}),define("search/auto-complete/views/auto-complete",["jquery","backbone","underscore"],function(e,t,n){var r,i=2,s={ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,LEFT_CMD:91};return r=t.View.extend({events:{"mouseover .auto-complete-list li":"mouseOverResult","mousedown .auto-complete-list li":"clickOnSuggest",'focus input[type="text"]':"clear",'keydown input[type="text"]':"keyDown",'keyup input[type="text"]':"keyUp"},initialize:function(){this.$input=this.$el.find('input[type="text"]'),this.$list=this.$el.find(".auto-complete-list"),this.isHidden=!0,this.timeout=0,this.suggestTemplates={"type-1":n.template(e(this.options.defaultSuggestionTplId).html()),"type-2":n.template(e(this.options.inCategorySuggestionTplId).html()),"type-3":n.template(e(this.options.inHistorySuggestionTplId).html())},this.collection.on("reset",this.dataReceived,this),this.collection.on("hide",this.hide,this),this.collection.on("removeItem",this.query,this),this.query()},keyDown:function(e){switch(e.keyCode){case s.DOWN_ARROW:case s.UP_ARROW:this.move(e);break;case s.ENTER:this.search(e)}},keyUp:function(t){switch(t.keyCode){case s.LEFT_CMD:case s.DOWN_ARROW:case s.RIGHT_ARROW:case s.UP_ARROW:case s.LEFT_ARROW:case s.SHIFT:case s.CTRL:case s.ALT:case s.ENTER:break;case s.ESCAPE:this.hide();break;default:this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(e.proxy(this.query,this),this.options.delay)}t.stopPropagation(),t.preventDefault()},move:function(e){switch(e.keyCode){case s.DOWN_ARROW:e.preventDefault(),this.next();break;case s.UP_ARROW:e.preventDefault(),this.prev()}e.stopPropagation()},next:function(){if(!this.$list.children().length){this.show(),this.query();return}if(this.isHidden){this.show();return}var t=this.$list.find("li.active").removeClass("active"),n=t.next();n.length||(this.show(),n=e(this.$list.find("li")[0])),this.$input.val(n.find(".phrase").text()),n.addClass("active")},prev:function(){if(!this.$list.children().length||this.isHidden)return;var t=e("li.active",this.$list).removeClass("active"),n=t.prev();n.length||(n=this.$list.find("li").last()),this.$input.val(n.find(".phrase").text()),n.addClass("active")},mouseOverResult:function(t){this.$list.find("li.active").removeClass("active"),e(t.currentTarget).addClass("active")},clickOnSuggest:function(t){var n=e(t.currentTarget);this.$input.val(n.find(".phrase").text()),this.search(t)},selectSearchType:function(){var e=this.$list.find("li.active");e.data("type")===i&&(this.$('select[name="search_scope"] option:selected').val().indexOf("userItems-")>=0?this.trigger("request-search-param-add",{name:"id",value:e.data("category")}):this.trigger("request-search-type-change",{type:"category",id:e.data("category")}))},search:function(e){e.preventDefault(),this.selectSearchType(),this.$el.find('input[type="submit"]').trigger("click"),this.hide()},query:function(){this.collection.query(this.$input.val())},clear:function(){this.$list.html(),this.hide()},dataReceived:function(){this.isHidden&&this.show(),this.render()},show:function(){this.trigger("show"),this.isHidden=!1},hide:function(){this.trigger("hide"),this.isHidden=!0},render:function(){var e="",t,n;this.collection.length&&(this.collection.each(function(r){r.get("match")!==!1&&(t="type-"+r.get("type"),n=this.suggestTemplates[t],e+=n(r.toJSON()))},this),e="<ul>"+e+"</ul>"),this.$list.html(e)}}),r}),define("search/auto-complete/views/history",["jquery","backbone","underscore","search/auto-complete/models/history"],function(e,t,n,r){var i=t.View.extend({events:{"mousedown .auto-complete-list li .remove":"removeItem","click .auto-complete-list li .remove":"preventDefault",'click input[type="submit"]':"addItem"},initialize:function(){this.$input=this.$el.find('input[type="text"]')},addItem:function(e){this.collection.addItem(new r({text:this.$input.val()}),{at:0})},removeItem:function(t){this.preventDefault(t),t.stopPropagation(),e(t.currentTarget).parent("li").fadeOut(300,e.proxy(function(){this.collection.removeItem(e(t.currentTarget).data("id"))},this))},preventDefault:function(e){e.preventDefault()}});return i}),define("search/auto-complete/app",["search/auto-complete/collections/auto-complete","search/auto-complete/views/auto-complete","search/auto-complete/views/history"],function(e,t,n){return function(r){var i,s,o;return i=new e([],r),r.collection=i,s=new t(r),o=new n(r),s}}),define("search/search-form",["jquery","backbone","search/auto-complete/app"],function(e,t,n){t.$=e;var r=t.View.extend({currentCategory:null,events:{"click div.search-type-select strong":"toggleSearchType","click div.search-type-select ul a":"selectSearchType",'blur input[type="text"]':"blur",'click input[type="text"]':"setFormAsActive","mousedown .in-description":"inDescriptionToggle","change .in-description input":"inDescriptionToggle",submit:"validate",click:"stopPropagation"},initialize:function(e){this.$input=this.$el.find('input[type="text"]'),this.$searchType=this.$el.find("div.search-type-select"),this.autoComplete=n(e.autoComplete),this.isActive=!1,this.stayFocused=!1,this.dispatcher=e.dispatcher,this.preventRedirect=this.$el.data("preventRedirect"),this.listenTo(this.dispatcher,"search:getCurrentCategory",this.getCurrentCategory),this.autoComplete.on("show",this.setFormAsActive,this).on("hide",this.setFormAsInactive,this).on("request-search-type-change",this.selectCustomSearchType,this).on("request-search-param-add",this.addCustomParameter,this),this.broadcastCurrentFilter()},broadcastCurrentFilter:function(){var e={name:this.$searchType.find("strong").data("filterId"),type:"default"};if(e.name.search("category")!==-1){e.name=e.name.replace("category-",""),e.type="category",this.dispatcher.trigger("searchFilter",e);return}if(e.name.search("department")!==-1){e.name=e.name.replace("department-",""),e.type="department",this.dispatcher.trigger("searchFilter",e);return}this.dispatcher.trigger("searchFilter",e)},render:function(){this.el.setAttribute("novalidate","novalidate"),this.correctBrowserBackBehavior(),e(document).on("click",e.proxy(this.setFormAsInactive,this)),!Modernizr.input.autofocus&&this.$input.hasClass("autofocus")&&(this.$input.focus(),this.setFormAsInactive())},stopPropagation:function(e){e.stopPropagation()},validate:function(){if(!e.trim(this.$input.val()).length)return!1;if(this.preventRedirect)return t.Events.trigger("g-search-submit",{action:this.$el.attr("action"),params:{string:this.$input.val(),search_scope:this.$el.find('[name="search_scope"]').val()}}),!1},toggleSearchType:function(){this.$searchType.hasClass("active")?this.searchTypeHide():this.searchTypeShow()},searchTypeShow:function(){this.isActive&&this.setFormAsInactive(),this.$searchType.addClass("active")},searchTypeHide:function(){this.$searchType.removeClass("active")},setFormAsActive:function(){if(this.isActive)return;this.$el.addClass("active"),this.searchTypeHide(),this.isActive=!0},setFormAsInactive:function(e){if(e&&e.type==="keydown"&&e.which!==27)return;this.searchTypeHide(),this.$el.removeClass("active"),this.isActive=!1},inDescriptionToggle:function(){this.stayFocused=!0},blur:function(e){this.stayFocused?this.stayFocused=!1:this.setFormAsInactive()},selectSearchType:function(t){var n=this.$el.find("select"),r=e(t.currentTarget),i=r.attr("href").split("#")[1].split("-")[0],s=this.$el.data("actions");this.currentCategory=i,this.$searchType.find("span").text(r.text()),this.$searchType.find("strong").attr("title",e.trim(r.text())),n.find("option:selected").prop("selected",!1),n.find('option[value="'+i+'"]').prop("selected",!0),i=i in s?i:"default",this.$el.attr("action",s[i].action),this.$input.attr("name",s[i].param),this.searchTypeHide(),this.$searchType.find("a.active").removeClass("active"),r.addClass("active"),e.trim(this.$input.val()).length||(this.setFormAsActive(),this.$input.focus()),t.preventDefault()},selectCustomSearchType:function(e){this.$el.find("option.custom-search-type").attr("value",e.type+"-"+e.id).prop("selected",!0)},addCustomParameter:function(e){this.$el.append('<input type="hidden" name="'+e.name+'" value="'+e.value+'">')},correctBrowserBackBehavior:function(){var e=this.$searchType.find("a.active").attr("href").split("#")[1];this.$el.find("select").find('option[value="'+e+'"]').prop("selected",!0)}});return r}),define("search/sticky-bar/views/bar",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({initialize:function(){this.$wrapper=this.$el.parent(),this.wrapperTop=this.$wrapper.offset().top,this.barWrapper=this.$wrapper.parents(".main-header-wrapper"),this.barWrapperOffset=this.barWrapper.next(".sticky-header-offset"),this.treshold=this.wrapperTop+this.$wrapper.height()},render:function(){if(e("html").hasClass("quirks"))return;e(window).bind("scroll",e.proxy(this.observePosition,this)),this.observePosition()},observePosition:function(){var t=e(window).scrollTop(),n=this.model.getStickState();this.treshold<t&&!n?this.stick():this.treshold>t&&n&&this.unStick()},stick:function(){this.model.setStickState(!0),this.barWrapper.addClass("sticky"),this.barWrapperOffset.addClass("sticky")},unStick:function(){this.model.setStickState(!1),this.barWrapper.removeClass("sticky"),this.barWrapperOffset.removeClass("sticky")}});return r}),typeof JSON!="object"&&(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;typeof JSON.stringify!="function"&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("json",function(e){return function(){var t,n;return t||e.JSON}}(this)),define("search/sticky-bar/models/barStates",["jquery","backbone","json"],function(e,t,n){var r=t.Model.extend({defaults:{isStick:!1},getStickState:function(){return this.isStick},setStickState:function(e){this.isStick=e}});return r}),define("search/sticky-bar/app",["jquery","underscore","search/sticky-bar/views/bar","search/sticky-bar/models/barStates"],function(e,t,n,r){return function(e){e=t.defaults(e,{isHide:!1,storageName:"stickyBarHide"});var i=new r,s=new n({el:e.el,model:i});s.render()}}),define("search/app",["jquery","search/search-form","search/sticky-bar/app"],function(e,t,n){return function(r){var i,s,o;e("#main-search").length&&(i=new t({el:"#main-search",autoComplete:{el:"#main-search",url:"/Suggest/Index.php/suggestAjax",storage:"searchAutoCompleteHistory",defaultSuggestionTplId:"#default-suggestion-tpl",inCategorySuggestionTplId:"#in-category-suggestion-tpl",inHistorySuggestionTplId:"#in-history-suggestion-tpl",historyMatchLimit:2,totalMatchLimit:10,delay:150},dispatcher:r.dispatcher}),i.render(),e("#maWrapper").length?s={el:"#search-bar",isHide:!0,storageName:"stickyBarMaHide"}:s={el:"#search-bar",storageName:"stickyBarHide"},o=new n(s))}}),define("departments/navigationBar/views/NavigationBar",["jquery","underscore","backbone","main/utils"],function(e,t,n,r){var i=n.View.extend({events:{"manualOpen div.nav-tab":"openLayer","manualClose div.nav-tab":"closeAllLayers","mousemove div.nav-tab":"mouseOverNavElement","mouseleave div.nav-tab":"mouseOutNavElement","click a.nav-link":"clickOnNavElement","mouseover div.layer":"mouseOverLayer","mouseout div.layer":"mouseOutLayer","click .categories li.all a":"scrollToCategory"},initialize:function(){this.$navTabs=this.$("li"),this.openTimeout=0,this.closeTimeout=0,this.slideOutTimeout=0,this.openDelay=this.options.openDelay,this.resizeTimeout=0,this.$currentLayer=null,this.isTouchDevice=e("html").hasClass("touch"),this.isTouchDevice&&(this.events={})},render:function(){e("html").hasClass("quirks")&&this.flexBoxFallback(),this.options.isSideNav||(this.adjustLayerPosition(),e(window).on("resize",e.proxy(this.processResize,this)))},mouseOverNavElement:function(t){this.resetTimeouts(),this.closeTimeout=setTimeout(e.proxy(this.openLayer,this,t),this.openDelay)},mouseOutNavElement:function(){this.resetTimeouts(),this.openTimeout=setTimeout(e.proxy(this.closeAllLayers,this),this.options.closeDelay)},mouseOverLayer:function(){this.resetTimeouts()},mouseOutLayer:function(){this.closeTimeout=setTimeout(e.proxy(this.closeAllLayers,this),this.options.closeDelay)},clickOnNavElement:function(){clearTimeout(this.openTimeout)},resetTimeouts:function(){clearTimeout(this.closeTimeout),clearTimeout(this.openTimeout)},openLayer:function(e){var t=this.$(e.currentTarget).closest("li");t.hasClass("current")||(this.$currentLayer=t.find("div.nav-layer"),this.closeAllLayers(),t.addClass("current"),this.loadLayerContent(),this.openDelay/=2)},closeAllLayers:function(){this.openDelay=this.options.openDelay,this.$navTabs.removeClass("current")},loadLayerContent:function(){var t=this.$currentLayer.data("department");if(!this.model.isContentInCache(t)){this.$currentLayer.addClass("loading"),this.model.getLayerContent(t,{success:e.proxy(this.contentLoadSuccess,this),error:e.proxy(this.contentLoadError,this)});return}this.$currentLayer.children().length<1&&this.$currentLayer.html(this.model.getCachedLayerContent(t))},contentLoadSuccess:function(e){this.$currentLayer.removeClass("loading").html(e),this.options.isSideNav&&this.openSideNavLayer()},contentLoadError:function(e){this.$currentLayer.removeClass("loading"),this.closeAllLayers()},scrollToCategory:function(e){var t=window.location.href;t.split("#")[0]===e.currentTarget.href.split("#")[0]&&(this.closeAllLayers(),r.visual.scrollTo("#category-map"),e.preventDefault())},processResize:function(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(e.proxy(this.resizeEnd,this),100)},resizeEnd:function(){this.adjustLayerPosition()},adjustLayerPosition:function(){var t=20,n=672,r=this.$el.outerWidth(),i=this.$el.offset().left,s=r-n;for(var o=0,u=this.$navTabs.length;o<u;o++){var a=e(this.$navTabs[o]),f=a.find("a.nav-link").offset().left-i,l=f-s,c=0;l<0&&o>0?c=-t:l>-t&&(c=-l),a.find("div.nav-layer").css("left",c)}},flexBoxFallback:function(){var n=this.$el.outerWidth(),r=this.$navTabs.length,i=[],s=0,o=0,u=0;this.$navTabs.each(function(t,n){e(n).removeAttr("style"),i[t]=e(n).outerWidth(),s+=i[t]}),o=Math.floor((n-s)/--r/2*2),t.each(this.$navTabs,function(t,s){u=s===r?0:o,e(this.$navTabs[s]).css("width",(i[s]+u)*100/n+"%")},this)}});return i}),function(e,t){typeof define=="function"&&define.amd?define("ajax",[],function(){return e.ajax=t()}):e.ajax=t()}(this,function(){var e=function(){};return e.prototype.isUrlExternal=function(e){var t=new RegExp("^(?:[a-z]+:)?//","i");return t.test(e)},e.prototype.createXHRObject=function(e){var t=new XMLHttpRequest,n=this.isUrlExternal(e);return"withCredentials"in t||!n?t.open("GET",e,!0):typeof XDomainRequest!="undefined"?(t=new XDomainRequest,t.open("GET",e)):t=null,t},e.prototype.get=function(e){function i(){var t;r.readyState===4&&r.status===200?(t=r.getResponseHeader("Content-Type"),t&&t.indexOf("application/json")!==-1?n(JSON.parse(r.responseText)):n(r.responseText)):typeof XDomainRequest!="undefined"&&r instanceof XDomainRequest?r.contentType.indexOf("application/json")!==-1?n(JSON.parse(r.responseText)):n(r.responseText):r.readyState===4&&e.errorCallback()}var t=e.url,n=e.callback,r=this.createXHRObject(t);r.onload===undefined?r.onreadystatechange=i:r.onload=i,r.onerror=function(){e.errorCallback()},r.send(null)},e}),define("departments/navigationBar/models/NavigationBar",["jquery","backbone","ajax"],function(e,t,n){var r=t.Model.extend({currentDepartment:null,cache:{},initialize:function(){this.ajax=new n},isContentInCache:function(e){return!!this.cache[e]},getCachedLayerContent:function(e){return this.cache[e]},getLayerContent:function(t,n){if(typeof t!="string")return n.error();this.currentDepartment=t,this.ajax.get({url:this.url(),callback:e.proxy(this.dataLoadSuccess,this,n.success,t),errorCallback:n.error})},dataLoadSuccess:function(e,t,n){return this.cache[t]=n,e(n)},dataLoadError:function(e){return e()}});return r}),define("departments/navigationBar/main",["departments/navigationBar/views/NavigationBar","departments/navigationBar/models/NavigationBar","underscore"],function(e,t,n){return function(r){var i,s;r=n.defaults(r,{openDelay:400,closeDelay:300}),i=new t,i.urlRoot=r.urlRoot,i.url=function(){return this.urlRoot+"/"+this.currentDepartment},s=new e({model:i,el:r.el,openDelay:r.openDelay,closeDelay:r.closeDelay}),s.render()}}),function(e){typeof define=="function"&&define.amd?define("jquery.cookie",["jquery"],e):typeof exports=="object"?e(require("jquery")):e(jQuery)}(function(e){function n(e){return u.raw?e:encodeURIComponent(e)}function r(e){return u.raw?e:decodeURIComponent(e)}function i(e){return n(u.json?JSON.stringify(e):String(e))}function s(e){e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(t," ")),u.json?JSON.parse(e):e}catch(n){}}function o(t,n){var r=u.raw?t:s(t);return e.isFunction(n)?n(r):r}var t=/\+/g,u=e.cookie=function(t,s,a){if(s!==undefined&&!e.isFunction(s)){a=e.extend({},u.defaults,a);if(typeof a.expires=="number"){var f=a.expires,l=a.expires=new Date;l.setTime(+l+f*864e5)}return document.cookie=[n(t),"=",i(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var c=t?undefined:{},h=document.cookie?document.cookie.split("; "):[];for(var p=0,d=h.length;p<d;p++){var v=h[p].split("="),m=r(v.shift()),g=v.join("=");if(t&&t===m){c=o(g,s);break}!t&&(g=o(g))!==undefined&&(c[m]=g)}return c};u.defaults={},e.removeCookie=function(t,n){return e.cookie(t)===undefined?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}}),define("velalayout/GetUserLoginData",["jquery","jquery.cookie"],function(e){function t(){var t=e.cookie("qeppo_login2");this.$userNav=e("#user-nav"),this.userIdentity=t?JSON.parse(t):null,this.dc2=e.cookie("dc2")}return t.prototype.initialize=function(){this.$userNav.addClass("init"),this.synchronizeRecommendationDataInLocalStorage();if(this.userIdentity){this.showLoggedUserInfo();return}this.dc2&&this.$userNav.addClass("session-expired")},t.prototype.showLoggedUserInfo=function(){var t=this.createUserLoginLink();e("#user-login").append(t),this.$userNav.addClass("status-logged")},t.prototype.createUserLoginLink=function(){var t=this.$userNav.data("user-card-url")+this.userIdentity.id,n=this.userIdentity.username.replace(/<|>|\"/g,"");return e('<a href="'+t+'"><span>'+n+"</span></a>")},t.prototype.synchronizeRecommendationDataInLocalStorage=function(){localStorage&&localStorage.getItem("allActions")&&JSON.parse(localStorage.getItem("allActions")).ws3!==e.cookie("ws3")&&localStorage.removeItem("allActions")},t}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=[],i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},s=function(e,t){var n=i,r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+e.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(n.interpolate,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(n.evaluate||null,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"; __p.push('"}).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"")+"');}return __p.join('');";return r};define("tpl",[],function(){var i,o,u;return typeof window!="undefined"&&window.navigator&&window.document?o=function(e,t){var n=i.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(e){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&!!process.versions.node&&(u=require.nodeRequire("fs"),o=function(e,t){t(u.readFileSync(e,"utf8"))}),i={version:"0.24.0",strip:function(e){if(e){e=e.replace(t,"");var r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"").replace(/[\t]/g,"").replace(/[\r]/g,"")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw new Error("require.getXhr(): XMLHttpRequest not available");return t},get:o,load:function(e,t,n,o){var u=!1,a,f=e.indexOf("."),l=e.substring(0,f),c=e.substring(f+1,e.length);f=c.indexOf("!"),f!==-1&&(u=c.substring(f+1,c.length),u=u==="strip",c=c.substring(0,f)),a="nameToUrl"in t?t.nameToUrl(l,"."+c):t.toUrl(l+"."+c),i.get(a,function(t){t=s(t),o.isBuild||(t=new Function("obj",t)),t=u?i.strip(t):t,o.isBuild&&o.inlineText&&(r[e]=t),n(t)})},write:function(e,t,n){if(t in r){var s=i.jsEscape(r[t]);n("define('"+e+"!"+t+"', function() {return function(obj) { "+s.replace(/(\\')/g,"'").replace(/(\\\\)/g,"\\")+"}});\n")}}}})}(),define("tpl!velalayout/cartStatus/templates/cartPreviewLayer.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="cart-items-carousel-wrapper">    <div id="cart-items-carousel" class="cart-items-carousel">        <div class="cart-items-carousel-inner items-box">            <ul class="items-wrap">                '),_.each(items,function(e){__p.push('                    <li data-item-id="',e.id,'">                        '),e.imageUrl?__p.push('                            <a class="photo">                                <img src="',e.imageUrl,'" width="128" height="96">                            </a>                        '):__p.push('                            <a class="photo">                                <span class="no-photo"></span>                            </a>                        '),__p.push('                        <span class="price">',e.totalBuyNowPrice,'</span>                        <span class="quantity">',trans.pieces,": ",e.cartQuantity,'</span>                        <div class="additional">                            <h3><a href="',e.url,'"><span>',e.name,'</span></a></h3>                            <span class="quantity">',trans.forOnePiece," <b>",e.buyNowPrice,"</b></span>                        </div>                    </li>                ")}),__p.push('            </ul>        </div>    </div>    <div class="cart-items-carousel-controls">        <a class="cart-items-carousel-control left" href="#prev">&lsaquo;</a>        <a class="cart-items-carousel-control right" href="#next">&rsaquo;</a>    </div></div><div class="cart-item-extra">    <p><strong>',description.cartItemsCount,"</strong> ",description.cartItemCountDesc.toLowerCase(),"</p>    <p>",trans.from," <strong>",description.sellersCount,"</strong>  ",description.sellerCountDesc.toLowerCase(),'</p>    <a href="',basketurl,'" class="primary-btn btn" title="',trans.goToCart,'">',trans.goToCart,"</a></div>");return __p.join("")}}),define("velalayout/cartStatus/views/CartPreviewView",["jquery","backbone","underscore","tpl!velalayout/cartStatus/templates/cartPreviewLayer.html"],function(e,t,n,r){var i=4,s=t.View.extend({events:{"slid #cart-items-carousel":"checkBoundaryConditions","click a.left":"switchToPrevSlide","click a.right":"switchToNextSlide"},initialize:function(){this.$itemsWrap=null,this.$controls=null,this.itemsCount=null,this.itemWidth=null,this.slidesCount=null,this.currentSlide=null},render:function(){var e=this.model.toJSON();return e.items?(this.itemsCount=e.items.length,this.$el.html(r(e)),this.$el.removeClass("spinner"),this.initializeCarousel(),this):this},initializeCarousel:function(){return this.slidesCount=Math.ceil(this.itemsCount/i),this.currentSlide=1,this.$itemsWrap=this.$("ul.items-wrap"),this.itemWidth=this.$("ul.items-wrap li").outerWidth(),this.adjustLayerSizeToExposedItems(),this.itemsCount>1&&this.adjustCarouselToExposedItems(),this.slidesCount>1?(this.$el.addClass("show-controls"),this.$controls=this.$("a.cart-items-carousel-control"),this.checkBoundaryConditions()):this.$el.removeClass("show-controls"),this},adjustLayerSizeToExposedItems:function(){this.$itemsWrap.css("width",this.itemsCount*this.itemWidth)},adjustCarouselToExposedItems:function(){var e=this.itemsCount>i?i:this.itemsCount;this.$("div.cart-items-carousel").css("width",e*this.itemWidth)},switchToNextSlide:function(e){this.currentSlide<this.slidesCount&&this.slideTo(this.currentSlide+1),e.preventDefault()},switchToPrevSlide:function(e){this.currentSlide>1&&this.slideTo(this.currentSlide-1),e.preventDefault()},slideTo:function(e){var t=e*i*this.itemWidth,n=this.itemsCount*this.itemWidth,r=-(Math.min(t,n)-i*this.itemWidth);this.$itemsWrap.css("left",r),this.currentSlide=e,this.checkBoundaryConditions()},checkBoundaryConditions:function(){var t=e(this.$controls[0]),n=e(this.$controls[1]);this.$controls.removeClass("unactive"),this.currentSlide===1?t.addClass("unactive"):this.currentSlide===this.slidesCount&&n.addClass("unactive")},clear:function(){this.$el.html(""),this.$el.addClass("spinner")}});return s}),define("velalayout/cartStatus/views/CartStatusView",["velalayout/cartStatus/views/CartPreviewView","backbone","jquery","jquery.cookie"],function(e,t,n){var r=t.View.extend({events:{mouseenter:"mouseEnterCartStatus",mouseleave:"mouseLeaveCartStatus"},initialize:function(t){this.openDelay=this.options.openDelay||500,this.closeDelay=this.options.closeDelay||400,this.addedItemOpenDelay=this.options.addedItemOpenDelay||2e3,this.openTimeout=null,this.closeTimeout=null,this.closeNewItemTimeout=null,this.addedItem=null,n("html").hasClass("touch")&&(this.events={}),this.cartPreviewView=new e({el:this.$("div.cart-preview"),model:this.model})},updateCartStatus:function(){var e=n.cookie("cartCount"),t=this.getCartTotalPrice();parseInt(e,10)?(this.$el.removeClass("empty"),this.$("span.count i").text(e),this.$("span.price").text(t)):(this.$("span.count i").text("0"),this.$("span.price").text(this.model.get("trans").cartIsEmpty),this.$el.addClass("empty")),this.$el.addClass("init")},getCartTotalPrice:function(){var e=(n.cookie("cartTotalPrice")||"").replace(/\+/g," ");return e.indexOf(" <")>0&&(e=e.slice(0,e.indexOf(" <"))),e},mouseEnterCartStatus:function(){clearTimeout(this.closeTimeout),clearTimeout(this.closeNewItemTimeout),this.$el.hasClass("active")||(this.openTimeout=setTimeout(n.proxy(this.openCartPreviewLayer,this),this.openDelay))},mouseLeaveCartStatus:function(){clearTimeout(this.openTimeout),this.closeTimeout=setTimeout(n.proxy(this.hideCartPreviewLayer,this),this.closeDelay)},openCartPreviewLayer:function(){this.updateCartStatus(),this.$el.hasClass("empty")||(this.$el.addClass("active"),this.model.fetch({cache:!1,success:n.proxy(this.showLayerContent,this),error:n.proxy(this.hideCartPreviewLayer,this)}))},hideCartPreviewLayer:function(){this.$el.removeClass("active"),this.$el.find("li").removeClass("blink"),this.cartPreviewView.clear(),clearTimeout(this.closeNewItemTimeout)},showLayerContent:function(){this.cartPreviewView.render(),this.addedItem&&(this.blinkNewItem(this.addedItem.get("id")),this.closeNewItemTimeout=setTimeout(n.proxy(this.hideCartPreviewLayer,this),this.addedItemOpenDelay),this.addedItem=null)},blinkNewItem:function(e){this.$el.find('[data-item-id="'+e+'"]').addClass("blink")},refreshBasket:function(e){this.addedItem=e,this.hideCartPreviewLayer(),this.mouseEnterCartStatus()}});return r}),define("velalayout/cartStatus/views/AddToCartView",["jquery","backbone"],function(e,t){var n=t.View.extend({events:{"click .new-basket-flow":"clickHandler"},initialize:function(e){this.cartStatusView=this.options.cartStatusView||null,this.cartStatusView&&this.cartStatusView.listenTo(this,"refreshBasket",this.cartStatusView.refreshBasket)},clickHandler:function(t){t.preventDefault(),this.saveData(e(t.currentTarget))},saveData:function(e){var t=this.$el.find("#item-quantity-input"),n=1;this.isValid(e)&&(this.disableBtn(e),t.length&&(n=t.val()),this.model.set({id:e.data("id"),cartid:e.data("cartid"),quantity:n,quantityAdd:1,sesstoken:e.data("sesstoken")}),this.fetchIt(e))},isValid:function(e){var t=e.data("id")||"",n=e.data("sesstoken")||"";return t!==""&&n!==""},fetchIt:function(t){this.model.fetch({data:e.param(this.model.toJSON()),success:e.proxy(this.refreshBasket,this,t),error:e.proxy(this.enableBtn,this,t)})},refreshBasket:function(e){this.enableBtn(e),this.trigger("refreshBasket",this.model)},disableBtn:function(e){e.attr("disabled","disabled")},enableBtn:function(e){e.removeAttr("disabled")}});return n}),define("velalayout/cartStatus/main",["velalayout/cartStatus/views/CartStatusView","velalayout/cartStatus/views/AddToCartView","jquery","backbone","underscore"],function(e,t,n,r,i){return{initialize:function(i){if(n.cookie("cartVersion")==="1"){n(i.el).hide(),n("#cart-status-header").show().removeClass("hidden");return}var s=new r.Model;s.url=i.previewUrl,s.set("trans",n(i.el).data("trans")),s.set("basketurl",n(i.el).data("basket-url"));var o=new e({model:s,el:i.el});o.updateCartStatus();var u="#siBidForm2",a=n("#listing").length;if(n("#add-to-cart-btn").length||a){a&&(u="body");var f=new r.Model;f.url=i.addUrl;var l=new t({model:f,el:u,cartStatusView:o})}}}}),define("velalayout/login-tip",["jquery","jquery.cookie"],function(e){var t="authenticationHint",n=location.host.split("."),r;return function(){e.cookie(t)&&typeof e.fn.popover=="function"&&(e("#user-login a").popover("show"),e("a.popover-close").on("click",function(s){s.preventDefault();for(r=0;r<n.length-1;r++){var o="."+n.slice(r,n.length).join(".");e.cookie(t,{path:"/",domain:o,expires:-1})}e("#user-login a").popover("destroy")}))}}),define("cookiepolicy/views/banner",["jquery","underscore","backbone"],function(e,t,n){var r=n.View.extend({events:{"click a.close":"hideBanner"},anchorTemplate:t.template('<a target="_blank" href="<%= url %>"><span><%= anchor %></span></a>'),initialize:function(){this.template=this.options.template},render:function(){this.model.getStorage(this.options.storageName)||e("body > .main-wrapper").prepend(e(this.renderBanner()))},renderBanner:function(){return this.setElement(this.template({message:this.prepareMessage()})),this.$el},prepareMessage:function(){var e=this.options.langs,t=this.anchorTemplate({url:this.options.policyPageUrl,anchor:e.anchor});return e.message.replace("%link%",t)},hideBanner:function(t){t.preventDefault(),e(this.$el.children("div")[0]).addClass("slide-out"),this.model.setStorage(this.options.storageName,!0)}});return r}),define("cookiepolicy/models/storage",[],function(){var e=function(){};return e.prototype={getStorage:function(e){if(typeof e!="string"&&e.length)throw new TypeError("Param name must be a string");return localStorage.getItem(e)},setStorage:function(e,t){if(typeof e=="undefined"||typeof t=="undefined")throw new TypeError("Params name and value required");localStorage.setItem(e,t)}},e}),define("tpl!cookiepolicy/templates/banner.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="vela">    <div class="cookie-policy-banner vela" id="cookie-policy-banner">        <div class="inner">            <p>',message,'</p>            <a class="close" href="#close">&times;</a>        </div>    </div></div>');return __p.join("")}}),define("cookiepolicy/main",["underscore","cookiepolicy/views/banner","cookiepolicy/models/storage","tpl!cookiepolicy/templates/banner.html"],function(e,t,n,r){return function(i){var s;i=e.defaults(i,{storageName:"policyBannerHide"}),s=new t({model:new n,template:r,storageName:i.storageName,langs:i.langs,policyPageUrl:i.policyPageUrl}),s.render()}}),function(e,t){function r(){if(n.READY)return;n.event.determineEventTypes(),n.utils.each(n.gestures,function(e){n.detection.register(e)}),n.event.onTouch(n.DOCUMENT,n.EVENT_MOVE,n.detection.detect),n.event.onTouch(n.DOCUMENT,n.EVENT_END,n.detection.detect),n.READY=!0}var n=function(e,t){return new n.Instance(e,t||{})};n.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},n.HAS_POINTEREVENTS=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,n.HAS_TOUCHEVENTS="ontouchstart"in e,n.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android|silk/i,n.NO_MOUSEEVENTS=n.HAS_TOUCHEVENTS&&e.navigator.userAgent.match(n.MOBILE_REGEX),n.EVENT_TYPES={},n.DIRECTION_DOWN="down",n.DIRECTION_LEFT="left",n.DIRECTION_UP="up",n.DIRECTION_RIGHT="right",n.POINTER_MOUSE="mouse",n.POINTER_TOUCH="touch",n.POINTER_PEN="pen",n.EVENT_START="start",n.EVENT_MOVE="move",n.EVENT_END="end",n.DOCUMENT=e.document,n.plugins=n.plugins||{},n.gestures=n.gestures||{},n.READY=!1,n.utils={extend:function(n,r,i){for(var s in r){if(n[s]!==t&&i)continue;n[s]=r[s]}return n},each:function(e,n,r){var i,s;if("forEach"in e)e.forEach(n,r);else if(e.length!==t){for(i=0,s=e.length;i<s;i++)if(n.call(r,e[i],i,e)===!1)return}else for(i in e)if(e.hasOwnProperty(i)&&n.call(r,e[i],i,e)===!1)return},hasParent:function(e,t){while(e){if(e==t)return!0;e=e.parentNode}return!1},getCenter:function(t){var r=[],i=[];return n.utils.each(t,function(e){r.push(typeof e.clientX!="undefined"?e.clientX:e.pageX),i.push(typeof e.clientY!="undefined"?e.clientY:e.pageY)}),{pageX:(Math.min.apply(Math,r)+Math.max.apply(Math,r))/2,pageY:(Math.min.apply(Math,i)+Math.max.apply(Math,i))/2}},getVelocity:function(t,n,r){return{x:Math.abs(n/t)||0,y:Math.abs(r/t)||0}},getAngle:function(t,n){var r=n.pageY-t.pageY,i=n.pageX-t.pageX;return Math.atan2(r,i)*180/Math.PI},getDirection:function(t,r){var i=Math.abs(t.pageX-r.pageX),s=Math.abs(t.pageY-r.pageY);return i>=s?t.pageX-r.pageX>0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT:t.pageY-r.pageY>0?n.DIRECTION_UP:n.DIRECTION_DOWN},getDistance:function(t,n){var r=n.pageX-t.pageX,i=n.pageY-t.pageY;return Math.sqrt(r*r+i*i)},getScale:function(t,n){return t.length>=2&&n.length>=2?this.getDistance(n[0],n[1])/this.getDistance(t[0],t[1]):1},getRotation:function(t,n){return t.length>=2&&n.length>=2?this.getAngle(n[1],n[0])-this.getAngle(t[1],t[0]):0},isVertical:function(t){return t==n.DIRECTION_UP||t==n.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(t,r){if(!r||!t||!t.style)return;n.utils.each(["webkit","khtml","moz","Moz","ms","o",""],function(e){n.utils.each(r,function(n){e&&(n=e+n.substring(0,1).toUpperCase()+n.substring(1)),n in t.style&&(t.style[n]=n)})}),r.userSelect=="none"&&(t.onselectstart=function(){return!1}),r.userDrag=="none"&&(t.ondragstart=function(){return!1})}},n.Instance=function(e,t){var i=this;return r(),this.element=e,this.enabled=!0,this.options=n.utils.extend(n.utils.extend({},n.defaults),t||{}),this.options.stop_browser_behavior&&n.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),n.event.onTouch(e,n.EVENT_START,function(e){i.enabled&&n.detection.startDetect(i,e)}),this},n.Instance.prototype={on:function(t,r){var i=t.split(" ");return n.utils.each(i,function(e){this.element.addEventListener(e,r,!1)},this),this},off:function(t,r){var i=t.split(" ");return n.utils.each(i,function(e){this.element.removeEventListener(e,r,!1)},this),this},trigger:function(t,r){r||(r={});var i=n.DOCUMENT.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=r;var s=this.element;return n.utils.hasParent(r.target,s)&&(s=r.target),s.dispatchEvent(i),this},enable:function(t){return this.enabled=t,this}};var i=null,s=!1,o=!1;n.event={bindDom:function(e,t,r){var i=t.split(" ");n.utils.each(i,function(t){e.addEventListener(t,r,!1)})},onTouch:function(t,r,u){var a=this;this.bindDom(t,n.EVENT_TYPES[r],function(f){var l=f.type.toLowerCase();if(l.match(/mouse/)&&o)return;l.match(/touch/)||l.match(/pointerdown/)||l.match(/mouse/)&&f.which===1?s=!0:l.match(/mouse/)&&!f.which&&(s=!1),l.match(/touch|pointer/)&&(o=!0);var c=0;if(s){n.HAS_POINTEREVENTS&&r!=n.EVENT_END?c=n.PointerEvent.updatePointer(r,f):l.match(/touch/)?c=f.touches.length:o||(c=l.match(/up/)?0:1),c>0&&r==n.EVENT_END?r=n.EVENT_MOVE:c||(r=n.EVENT_END);if(c||i===null)i=f;u.call(n.detection,a.collectEventData(t,r,a.getTouchList(i,r),f)),n.HAS_POINTEREVENTS&&r==n.EVENT_END&&(c=n.PointerEvent.updatePointer(r,f))}c||(i=null,s=!1,o=!1,n.PointerEvent.reset())})},determineEventTypes:function(){var t;n.HAS_POINTEREVENTS?t=n.PointerEvent.getEvents():n.NO_MOUSEEVENTS?t=["touchstart","touchmove","touchend touchcancel"]:t=["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],n.EVENT_TYPES[n.EVENT_START]=t[0],n.EVENT_TYPES[n.EVENT_MOVE]=t[1],n.EVENT_TYPES[n.EVENT_END]=t[2]},getTouchList:function(t){return n.HAS_POINTEREVENTS?n.PointerEvent.getTouchList():t.touches?t.touches:(t.identifier=1,[t])},collectEventData:function(t,r,i,s){var o=n.POINTER_TOUCH;if(s.type.match(/mouse/)||n.PointerEvent.matchType(n.POINTER_MOUSE,s))o=n.POINTER_MOUSE;return{center:n.utils.getCenter(i),timeStamp:(new Date).getTime(),target:s.target,touches:i,eventType:r,pointerType:o,srcEvent:s,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return n.detection.stopDetect()}}}},n.PointerEvent={pointers:{},getTouchList:function(){var e=this,t=[];return n.utils.each(e.pointers,function(e){t.push(e)}),t},updatePointer:function(e,t){return e==n.EVENT_END?this.pointers={}:(t.identifier=t.pointerId,this.pointers[t.pointerId]=t),Object.keys(this.pointers).length},matchType:function(e,t){if(!t.pointerType)return!1;var r=t.pointerType,i={};return i[n.POINTER_MOUSE]=r===t.MSPOINTER_TYPE_MOUSE||r===n.POINTER_MOUSE,i[n.POINTER_TOUCH]=r===t.MSPOINTER_TYPE_TOUCH||r===n.POINTER_TOUCH,i[n.POINTER_PEN]=r===t.MSPOINTER_TYPE_PEN||r===n.POINTER_PEN,i[e]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}},n.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(t,r){if(this.current)return;this.stopped=!1,this.current={inst:t,startEvent:n.utils.extend({},r),lastEvent:!1,name:""},this.detect(r)},detect:function(t){if(!this.current||this.stopped)return;t=this.extendEventData(t);var r=this.current.inst.options;return n.utils.each(this.gestures,function(e){if(!this.stopped&&r[e.name]!==!1&&e.handler.call(e,t,this.current.inst)===!1)return this.stopDetect(),!1},this),this.current&&(this.current.lastEvent=t),t.eventType==n.EVENT_END&&!t.touches.length-1&&this.stopDetect(),t},stopDetect:function(){this.previous=n.utils.extend({},this.current),this.current=null,this.stopped=!0},extendEventData:function(t){var r=this.current.startEvent;r&&(t.touches.length!=r.touches.length||t.touches===r.touches)&&(r.touches=[],n.utils.each(t.touches,function(e){r.touches.push(n.utils.extend({},e))}));var i=t.timeStamp-r.timeStamp,s=t.center.pageX-r.center.pageX,o=t.center.pageY-r.center.pageY,u=n.utils.getVelocity(i,s,o),a,f;return t.eventType==="end"?(a=this.current.lastEvent&&this.current.lastEvent.interimAngle,f=this.current.lastEvent&&this.current.lastEvent.interimDirection):(a=this.current.lastEvent&&n.utils.getAngle(this.current.lastEvent.center,t.center),f=this.current.lastEvent&&n.utils.getDirection(this.current.lastEvent.center,t.center)),n.utils.extend(t,{deltaTime:i,deltaX:s,deltaY:o,velocityX:u.x,velocityY:u.y,distance:n.utils.getDistance(r.center,t.center),angle:n.utils.getAngle(r.center,t.center),interimAngle:a,direction:n.utils.getDirection(r.center,t.center),interimDirection:f,scale:n.utils.getScale(r.touches,t.touches),rotation:n.utils.getRotation(r.touches,t.touches),startEvent:r}),t},register:function(r){var i=r.defaults||{};return i[r.name]===t&&(i[r.name]=!0),n.utils.extend(n.defaults,i,!0),r.index=r.index||1e3,this.gestures.push(r),this.gestures.sort(function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}),this.gestures}},n.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,correct_for_drag_min_distance:!0,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(t,r){if(n.detection.current.name!=this.name&&this.triggered){r.trigger(this.name+"end",t),this.triggered=!1;return}if(r.options.drag_max_touches>0&&t.touches.length>r.options.drag_max_touches)return;switch(t.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:if(t.distance<r.options.drag_min_distance&&n.detection.current.name!=this.name)return;if(n.detection.current.name!=this.name){n.detection.current.name=this.name;if(r.options.correct_for_drag_min_distance&&t.distance>0){var i=Math.abs(r.options.drag_min_distance/t.distance);n.detection.current.startEvent.center.pageX+=t.deltaX*i,n.detection.current.startEvent.center.pageY+=t.deltaY*i,t=n.detection.extendEventData(t)}}if(n.detection.current.lastEvent.drag_locked_to_axis||r.options.drag_lock_to_axis&&r.options.drag_lock_min_distance<=t.distance)t.drag_locked_to_axis=!0;var s=n.detection.current.lastEvent.direction;t.drag_locked_to_axis&&s!==t.direction&&(n.utils.isVertical(s)?t.direction=t.deltaY<0?n.DIRECTION_UP:n.DIRECTION_DOWN:t.direction=t.deltaX<0?n.DIRECTION_LEFT:n.DIRECTION_RIGHT),this.triggered||(r.trigger(this.name+"start",t),this.triggered=!0),r.trigger(this.name,t),r.trigger(this.name+t.direction,t),(r.options.drag_block_vertical&&n.utils.isVertical(t.direction)||r.options.drag_block_horizontal&&!n.utils.isVertical(t.direction))&&t.preventDefault();break;case n.EVENT_END:this.triggered&&r.trigger(this.name+"end",t),this.triggered=!1}}},n.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(t,r){switch(t.eventType){case n.EVENT_START:clearTimeout(this.timer),n.detection.current.name=this.name,this.timer=setTimeout(function(){n.detection.current.name=="hold"&&r.trigger("hold",t)},r.options.hold_timeout);break;case n.EVENT_MOVE:t.distance>r.options.hold_threshold&&clearTimeout(this.timer);break;case n.EVENT_END:clearTimeout(this.timer)}}},n.gestures.Release={name:"release",index:Infinity,handler:function(t,r){t.eventType==n.EVENT_END&&r.trigger(this.name,t)}},n.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_min_touches:1,swipe_max_touches:1,swipe_velocity:.7},handler:function(t,r){if(t.eventType==n.EVENT_END){if(r.options.swipe_max_touches>0&&t.touches.length<r.options.swipe_min_touches&&t.touches.length>r.options.swipe_max_touches)return;if(t.velocityX>r.options.swipe_velocity||t.velocityY>r.options.swipe_velocity)r.trigger(this.name,t),r.trigger(this.name+t.direction,t)}}},n.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(t,r){if(t.eventType==n.EVENT_END&&t.srcEvent.type!="touchcancel"){var i=n.detection.previous,s=!1;if(t.deltaTime>r.options.tap_max_touchtime||t.distance>r.options.tap_max_distance)return;i&&i.name=="tap"&&t.timeStamp-i.lastEvent.timeStamp<r.options.doubletap_interval&&t.distance<r.options.doubletap_distance&&(r.trigger("doubletap",t),s=!0);if(!s||r.options.tap_always)n.detection.current.name="tap",r.trigger(n.detection.current.name,t)}}},n.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(t,r){if(r.options.prevent_mouseevents&&t.pointerType==n.POINTER_MOUSE){t.stopDetect();return}r.options.prevent_default&&t.preventDefault(),t.eventType==n.EVENT_START&&r.trigger(this.name,t)}},n.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(t,r){if(n.detection.current.name!=this.name&&this.triggered){r.trigger(this.name+"end",t),this.triggered=!1;return}if(t.touches.length<2)return;r.options.transform_always_block&&t.preventDefault();switch(t.eventType){case n.EVENT_START:this.triggered=!1;break;case n.EVENT_MOVE:var i=Math.abs(1-t.scale),s=Math.abs(t.rotation);if(i<r.options.transform_min_scale&&s<r.options.transform_min_rotation)return;n.detection.current.name=this.name,this.triggered||(r.trigger(this.name+"start",t),this.triggered=!0),r.trigger(this.name,t),s>r.options.transform_min_rotation&&r.trigger("rotate",t),i>r.options.transform_min_scale&&(r.trigger("pinch",t),r.trigger("pinch"+(t.scale<1?"in":"out"),t));break;case n.EVENT_END:this.triggered&&r.trigger(this.name+"end",t),this.triggered=!1}}},typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("hammer",[],function(){return n}):typeof module=="object"&&typeof module.exports=="object"?module.exports=n:e.Hammer=n}(this),define("navigation/views/NavigationAbstractView",["backbone"],function(e){return e.View.extend({cmEventsQueue:[],close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose()},getReferer:function(){return"?ref=side-navigation"},sendQueuedEvents:function(){var e=0,t;for(e;e<this.cmEventsQueue.length;e++){t=this.cmEventsQueue[e];try{window.cm.event(t)}catch(n){window.console.info("Fail to log cookie monster "+t.cat+" event.")}}this.cmEventsQueue.length=0},sendEventForCookieMonster:function(e,t,n,r){var i={cat:t,a:n,lab:e};r!==undefined&&(i.v=r),this.cmEventsQueue.push(i);if(typeof window.cm=="undefined")return;this.sendQueuedEvents()}})}),define("tpl!navigation/templates/department-template.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<span class="department-name">',label,'</span><i class="sprite arrow-right icon-arrow"></i>');return __p.join("")}}),define("navigation/views/departments-list/DepartmentView",["backbone","underscore","navigation/views/NavigationAbstractView","tpl!navigation/templates/department-template.html"],function(e,t,n,r){var i=n.extend({tagName:"li",className:"department",isClicked:!1,enableCategoriesNavigation:!0,events:{click:"changeDepartment"},redirectionEvents:{click:"redirectToDepartment"},initialize:function(e){this.enableCategoriesNavigation=e.enableCategoriesNavigation,this.enableCategoriesNavigation||(this.events=t.extend({},this.redirectionEvents))},changeDepartment:function(){if(this.isClicked)return;this.isClicked=!0,this.$el.trigger("animateForward"),this.$el.trigger("changeDepartment",this.model.get("name"))},redirectToDepartment:function(){window.location.pathname=this.model.get("url")},render:function(){return this.$el.html(r(this.model.toJSON())),this}});return i}),define("navigation/views/departments-list/DepartmentsListView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/departments-list/DepartmentView"],function(e,t,n,r){var i=n.extend({tagName:"ul",enableCategoriesNavigation:!0,className:function(){return"navigation-tab departments-list "+this.options.animationDirection},initialize:function(e){this._views=[],this.departmentsCollection=e.departmentsCollection,this.animationDirection=e.animationDirection,this.enableCategoriesNavigation=e.enableCategoriesNavigation},createSubViews:function(){var e=this;this.departmentsCollection.each(function(t){e._views.push(new r({model:t,enableCategoriesNavigation:e.enableCategoriesNavigation}))})},render:function(){this.createSubViews();var t=document.createDocumentFragment();return e.each(this._views,function(e){t.appendChild(e.render().el)}),this.$el.append(t),this},onClose:function(){e.each(this._views,function(e){e.close()})}});return i}),define("tpl!navigation/templates/current-category-template.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<i class="sprite arrow-left icon-arrow"></i><span class="current-category-name separator-right">',name,'</span><a href="/',alias,'" class="sprite th-list-icon go-to-current-category"></a>');return __p.join("")}}),define("navigation/views/navigation-tab/CurrentCategoryView",["backbone","underscore","navigation/views/NavigationAbstractView","tpl!navigation/templates/current-category-template.html"],function(e,t,n,r){var i=n.extend({tagName:"header",className:"current-category",template:null,isClicked:!1,events:{"click .current-category-name":"goBack"},initialize:function(e){e=t.defaults(e,{template:r}),this.template=e.template},goBack:function(){if(this.isClicked)return;this.isClicked=!0,this.$el.trigger("animateBack");if(this.model.get("parentId")===undefined){this.$el.trigger("showDepartmentsList");return}if(this.model.get("parentId")!==0){this.$el.trigger("changeCategory",this.model.get("parentId"));return}this.$el.trigger("showCurrentCategoryDepartment",this.model.get("categoryId"))},addReferer:function(){var e=this.model.get("alias");e||(e=this.model.get("url")),e+=this.getReferer(),this.model.set("alias",e)},render:function(){return this.addReferer(),this.$el.html(this.template(this.model.toJSON())),this}});return i}),define("tpl!navigation/templates/sub-category-template.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),leaf==1?__p.push('    <a href="/',alias,'" class="category-name category-leaf">',name,"</a>"):__p.push('    <span class="category-name">',name,'</span>    <i class="sprite arrow-right icon-arrow"></i>'),__p.push("");return __p.join("")}}),define("navigation/views/navigation-tab/SubCategoryView",["backbone","navigation/views/NavigationAbstractView","tpl!navigation/templates/sub-category-template.html"],function(e,t,n){var r=t.extend({tagName:"li",isDepartmentSubView:!1,isClicked:!1,baseClass:"sub-category",categoryEvents:{click:"selectCategory"},activeLeafEvents:{click:"preventRedirect"},preventRedirect:function(e){e.preventDefault()},getClass:function(){return this.model.get("active")?this.baseClass+" active":this.baseClass},setClass:function(){this.$el.addClass(this.getClass())},setEvents:function(){if(!this.model.get("leaf")){this.events=this.categoryEvents;return}this.model.get("active")&&(this.events=this.activeLeafEvents)},initialize:function(e){this.isDepartmentSubView=e.isDepartmentSubView,this.isDepartmentSubView&&this.parseDepartmentSubViewModel(),this.setClass(),this.setEvents()},selectCategory:function(){if(this.isClicked)return;this.isClicked=!0,this.$el.trigger("animateForward"),this.$el.trigger("changeCategory",this.model.get("categoryId"))},parseDepartmentSubViewModel:function(){var t=new e.Model,n;for(n in this.model)this.model.hasOwnProperty(n)&&t.set(n,this.model[n]);this.model=t},addReferer:function(){var e=this.model.get("alias");e+=this.getReferer(),this.model.set("alias",e)},render:function(){return this.addReferer(),this.$el.html(n(this.model.toJSON())),this}});return r}),define("navigation/views/navigation-tab/SubCategoriesListView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/navigation-tab/SubCategoryView"],function(e,t,n,r){var i=n.extend({tagName:"ul",className:"sub-categories-list",initialize:function(e){this._views=[],this.categoriesList=e.categoriesList,this.isDepartmentSubView=e.isDepartmentSubView,this.sortCategoriesList=e.sortCategoriesList,this.sortCategoriesList&&this.sortCategoriesByPosition(),this.createCategoriesSubViews()},createCategoriesSubViews:function(){var e=0;for(e;e<this.categoriesList.length;e++)this._views.push(new r({isDepartmentSubView:this.isDepartmentSubView,model:this.categoriesList[e]}))},sortCategoriesByPosition:function(){this.categoriesList.sort(function(e,t){return e.get("position")-t.get("position")})},render:function(){var t=document.createDocumentFragment();return e.each(this._views,function(e){t.appendChild(e.render().el)}),this.$el.html(t),this},onClose:function(){e.each(this._views,function(e){e.remove()})}});return i}),define("navigation/views/navigation-tab/CategoryTabView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/navigation-tab/CurrentCategoryView","navigation/views/navigation-tab/SubCategoriesListView"],function(e,t,n,r,i){var s=n.extend({tagName:"article",currentCategory:null,className:function(){return"navigation-tab category-tab "+this.options.animationDirection},initialize:function(e){this.currentCategory=e.currentCategory,this.categoriesList=e.categoriesList,this.animationDirection=e.animationDirection},render:function(){var e=document.createDocumentFragment();return this.currentCategoryView=new r({model:this.currentCategory}),e.appendChild(this.currentCategoryView.render().el),this.categoriesList.length>0&&(this.subCategoriesListView=new i({categoriesList:this.categoriesList,sortCategoriesList:!0}),e.appendChild(this.subCategoriesListView.render().el)),this.$el.append(e),this},onClose:function(){this.currentCategoryView.close(),this.categoriesList.length>0&&this.subCategoriesListView.close()}});return s}),define("tpl!navigation/templates/current-department-template.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<i class="sprite arrow-left icon-arrow"></i><span class="current-category-name separator-right">',label,'</span><a href="',alias,'" class="sprite th-list-icon go-to-current-category"></a>');return __p.join("")}}),define("navigation/views/navigation-tab/DepartmentTabView",["underscore","backbone","navigation/views/NavigationAbstractView","navigation/views/navigation-tab/CurrentCategoryView","navigation/views/navigation-tab/SubCategoriesListView","tpl!navigation/templates/current-department-template.html"],function(e,t,n,r,i,s){var o=n.extend({tagName:"article",currentDepartment:null,className:function(){return"navigation-tab departments-tab "+this.options.animationDirection},initialize:function(e){this.currentDepartment=e.currentDepartment,this.animationDirection=e.animationDirection},render:function(){var e=document.createDocumentFragment();return this.currentDepartmentView=new r({template:s,model:this.currentDepartment}),this.subCategoriesListView=new i({isDepartmentSubView:!0,categoriesList:this.currentDepartment.get("categories"),sortCategoriesList:!1}),e.appendChild(this.currentDepartmentView.render().el),e.appendChild(this.subCategoriesListView.render().el),this.$el.html(e),this},onClose:function(){this.currentDepartmentView.close(),this.subCategoriesListView.close()}});return o}),define("tpl!navigation/templates/sidenavigation-default-template.html",function(){return function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<section class="navigation-tabs"></section><section class="user-nav-container"></section>');return __p.join("")}}),function(e,t){var n=e.document,r=n.documentElement,i="overthrow-enabled",s="ontouchmove"in n,o="WebkitOverflowScrolling"in r.style||"msOverflowStyle"in r.style||!s&&e.screen.width>800||function(){var t=e.navigator.userAgent,n=t.match(/AppleWebKit\/([0-9]+)/),r=n&&n[1],i=n&&r>=534;return t.match(/Android ([0-9]+)/)&&RegExp.$1>=3&&i||t.match(/ Version\/([0-9]+)/)&&RegExp.$1>=0&&e.blackberry&&i||t.indexOf("PlayBook")>-1&&i&&!t.indexOf("Android 2")===-1||t.match(/Firefox\/([0-9]+)/)&&RegExp.$1>=4||t.match(/wOSBrowser\/([0-9]+)/)&&RegExp.$1>=233&&i||t.match(/NokiaBrowser\/([0-9\.]+)/)&&parseFloat(RegExp.$1)===7.3&&n&&r>=533}();e.overthrow={},e.overthrow.enabledClassName=i,e.overthrow.addClass=function(){r.className.indexOf(e.overthrow.enabledClassName)===-1&&(r.className+=" "+e.overthrow.enabledClassName)},e.overthrow.removeClass=function(){r.className=r.className.replace(e.overthrow.enabledClassName,"")},e.overthrow.set=function(){o&&e.overthrow.addClass()},e.overthrow.canBeFilledWithPoly=s,e.overthrow.forget=function(){e.overthrow.removeClass()},e.overthrow.support=o?"native":"none"}(this),function(e,t,n){if(t===n)return;t.easing=function(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t},t.tossing=!1;var r;t.toss=function(e,i){t.intercept();var s=0,u=e.scrollLeft,a=e.scrollTop,f={top:"+0",left:"+0",duration:50,easing:t.easing,finished:function(){}},l,c,h=!1;if(i)for(var p in f)i[p]!==n&&(f[p]=i[p]);return typeof f.left=="string"?(f.left=parseFloat(f.left),l=f.left+u):(l=f.left,f.left=f.left-u),typeof f.top=="string"?(f.top=parseFloat(f.top),c=f.top+a):(c=f.top,f.top=f.top-a),t.tossing=!0,r=setInterval(function(){s++<f.duration?(e.scrollLeft=f.easing(s,u,f.left,f.duration),e.scrollTop=f.easing(s,a,f.top,f.duration)):(l!==e.scrollLeft?e.scrollLeft=l:(h&&f.finished(),h=!0),c!==e.scrollTop?e.scrollTop=c:(h&&f.finished(),h=!0),t.intercept())},1),{top:c,left:l,duration:t.duration,easing:t.easing}},t.intercept=function(){clearInterval(r),t.tossing=!1}}(this,this.overthrow),function(e,t,n){if(t===n)return;t.scrollIndicatorClassName="overthrow";var r=e.document,i=r.documentElement,s=t.support==="native",o=t.canBeFilledWithPoly,u=t.configure,a=t.set,f=t.forget,l=t.scrollIndicatorClassName;t.closest=function(e,n){return!n&&e.className&&e.className.indexOf(l)>-1&&e||t.closest(e.parentNode)};var c=!1;t.set=function(){a();if(c||s||!o)return;e.overthrow.addClass(),c=!0,t.support="polyfilled",t.forget=function(){f(),c=!1,r.removeEventListener&&r.removeEventListener("touchstart",E,!1)};var u,l=[],h=[],p,d,v=function(){l=[],p=null},m=function(){h=[],d=null},g,y=function(e){g=u.querySelectorAll("textarea, input");for(var t=0,n=g.length;t<n;t++)g[t].style.pointerEvents=e},b=function(e,t){if(r.createEvent){var i=(!t||t===n)&&u.parentNode||u.touchchild||u,s;i!==u&&(s=r.createEvent("HTMLEvents"),s.initEvent("touchend",!0,!0),u.dispatchEvent(s),i.touchchild=u,u=i,i.dispatchEvent(e))}},E=function(e){t.intercept&&t.intercept(),v(),m(),u=t.closest(e.target);if(!u||u===i||e.touches.length>1)return;y("none");var n=e,r=u.scrollTop,s=u.scrollLeft,o=u.offsetHeight,a=u.offsetWidth,f=e.touches[0].pageY,c=e.touches[0].pageX,g=u.scrollHeight,w=u.scrollWidth,E=function(e){var t=r+f-e.touches[0].pageY,i=s+c-e.touches[0].pageX,y=t>=(l.length?l[0]:0),E=i>=(h.length?h[0]:0);t>0&&t<g-o||i>0&&i<w-a?e.preventDefault():b(n),p&&y!==p&&v(),d&&E!==d&&m(),p=y,d=E,u.scrollTop=t,u.scrollLeft=i,l.unshift(t),h.unshift(i),l.length>3&&l.pop(),h.length>3&&h.pop()},S=function(e){y("auto"),setTimeout(function(){y("none")},450),u.removeEventListener("touchmove",E,!1),u.removeEventListener("touchend",S,!1)};u.addEventListener("touchmove",E,!1),u.addEventListener("touchend",S,!1)};r.addEventListener("touchstart",E,!1)}}(this,this.overthrow),function(e,t){e.overthrow.set()}(this),define("overthrow",function(){}),define("navigation/views/SideNavigationView",["jquery","underscore","backbone","hammer","navigation/views/NavigationAbstractView","navigation/views/departments-list/DepartmentsListView","navigation/views/navigation-tab/CategoryTabView","navigation/views/navigation-tab/DepartmentTabView","tpl!navigation/templates/sidenavigation-default-template.html","overthrow"],function(e,t,n,r,i,s,o,u,a){var f=i.extend({userNavigationContainer:null,navigationTabsContainer:null,html:null,contentContainer:null,animationDuration:300,browserPaintTime:40,animationTimeout:null,browserPaintTimeout:null,enableCategoriesNavigation:!0,currentView:null,previousView:null,currentFilter:{},events:{changeCategory:"changeCategory",changeDepartment:"changeDepartment",showDepartmentsList:"renderDepartmentsList",showCurrentCategoryDepartment:"showCurrentCategoryDepartment",animateBack:"animateBack",animateForward:"animateForward"},initialize:function(e){this.userNavigation=e.userNavigation,this.model=e.model,this.dispatcher=e.dispatcher,this.headerType=e.headerType,this.contentContainer=this.$el.siblings(".main-wrapper"),this.html=this.$el.parents("html"),this.enableCategoriesNavigation=e.enableCategoriesNavigation,this.categoriesCollection=e.categoriesCollection,this.departmentsCollection=e.departmentsCollection,this.uniqueCMId=e.uniqueCMId,this.listenTo(this.dispatcher,"setSideNavVisibility",this.toggleSideNavVisibility),this.initAnimateClasses(),this.render(),this.html.hasClass("touch")&&this.attachTouchEvents();if(this.headerType==="simple-header"){this.html.addClass(this.headerType);return}this.$el.addClass("overthrow"),this.initListeners();if(!this.enableCategoriesNavigation){this.renderDepartmentsList();return}this.initSearchListeners()},attachTouchEvents:function(){r(this.el,{drag_min_distance:1,drag_block_horizontal:!0}).on("swipeleft",e.proxy(this.closeSideNav,this))},initListeners:function(){this.listenTo(this.categoriesCollection,"currentCategorySet",this.renderCategoryNavigationTab),this.listenTo(this.categoriesCollection,"categoryFetchError",this.renderDepartmentsList),this.listenTo(this.departmentsCollection,"currentDepartmentSet",this.renderDepartmentNavigationTab)},initSearchListeners:function(){this.listenTo(this.dispatcher,"searchFilter",this.storeSearchFilter),this.listenToOnce(this.dispatcher,"setSideNavVisibility",this.handleSearchFilter)},storeSearchFilter:function(e){this.currentFilter=e},showLoader:function(){this.$el.prepend('<div class="loader"></div>')},hideLoader:function(){this.$(".loader").remove()},handleSearchFilter:function(){this.showLoader();switch(this.currentFilter.type){case"department":this.changeDepartment(this.currentFilter.name);break;case"category":this.changeCategory(this.currentFilter.name);break;default:this.renderDepartmentsList()}},initAnimateClasses:function(){this.$el.addClass("slide-out-navigation"),this.contentContainer.toggleClass("slide-out-navigation")},toggleSideNavVisibility:function(){this.$el.toggleClass("slide-in-navigation"),this.html.toggleClass("side-nav-active"),this.contentContainer.toggleClass("slide-in-navigation")},animateBack:function(){this.animationDirection="slide-from-left"},animateForward:function(){this.animationDirection="slide-from-right"},closeSideNav:function(){this.dispatcher.trigger("toggleSideNavVisibility"),this.sendEventForCookieMonster(this.uniqueCMId,"SideNavigation","swipe_hide"),this.toggleSideNavVisibility()},changeCategory:function(e,t){typeof t=="undefined"&&(t=e),this.categoriesCollection.setCurrentCategory(t)},changeDepartment:function(e,t){typeof t=="undefined"&&(t=e),this.departmentsCollection.setCurrentDepartment(t)},showCurrentCategoryDepartment:function(e,t){this.departmentsCollection.setDepartmentByCategoryId(t)},hidePreviousTabs:function(e){var t=0;for(t;t<e-1;t++)this.$(".navigation-tab").eq(t).removeClass("current")},animateTab:function(){var t=this.$(".navigation-tab").length;if(t>1){this.hidePreviousTabs(t),this.$(".navigation-tab").eq(t-1).addClass("current slide-in"),clearTimeout(this.animationTimeout),this.animationTimeout=setTimeout(e.proxy(this.removePreviousTab,this),this.animationDuration);return}this.$(".navigation-tab").eq(0).addClass("current")},removePreviousTab:function(){this.previousView.remove&&(this.previousView.trigger("close"),this.previousView.close())},delayTabAnimation:function(){clearTimeout(this.browserPaintTimeout),this.browserPaintTimeout=setTimeout(e.proxy(this.animateTab,this),this.browserPaintTime)},setPreviousView:function(){this.previousView=this.currentView},renderDepartmentsList:function(){this.hideLoader();if(!this.departmentsCollection.isDepartmentsListInCache()){this.listenTo(this.departmentsCollection,"sync",this.renderDepartmentsList),this.departmentsCollection.getDepartmentsList();return}return this.setPreviousView(),this.currentView=new s({departmentsCollection:this.departmentsCollection,animationDirection:this.animationDirection,enableCategoriesNavigation:this.enableCategoriesNavigation}),this.navigationTabsContainer.append(this.currentView.render().el),this.delayTabAnimation(),this},renderDepartmentNavigationTab:function(){return this.hideLoader(),this.setPreviousView(),this.currentView=new u({currentDepartment:this.departmentsCollection.currentDepartment,animationDirection:this.animationDirection}),this.navigationTabsContainer.append(this.currentView.render().el),this.delayTabAnimation(),this},renderCategoryNavigationTab:function(){return this.hideLoader(),this.setPreviousView(),this.currentView=new o({currentCategory:this.categoriesCollection.currentCategory,categoriesList:this.categoriesCollection.currentCategorySubCategories,animationDirection:this.animationDirection}),this.navigationTabsContainer.append(this.currentView.render().el),this.delayTabAnimation(),this},render:function(){return this.$el.append(a),this.userNavigationContainer=this.$el.find(".user-nav-container"),this.navigationTabsContainer=this.$el.find(".navigation-tabs"),this.userNavigationContainer.append(this.userNavigation),this}});return f}),define("navigation/models/CategoryModel",["backbone"],function(e){var t=e.Model.extend({initialize:function(){this.set("id",this.get("categoryId"))}});return t}),define("navigation/collections/CategoriesCollection",["backbone","underscore","jquery","navigation/models/CategoryModel"],function(e,t,n,r){return e.Collection.extend({categoryId:null,currentCategory:null,activeLeaf:null,currentCategorySubCategories:[],baseUrl:"",model:r,categoryFetchError:!1,initialize:function(e){this.baseUrl=e.baseUrl,this.listenTo(this,"sync",this.setCurrentCategoryOnSync)},url:function(){return this.baseUrl.replace("{categoryId}",this.currentCategoryId)},fetchCurrentCategory:function(){this.fetch({remove:!1})},parse:function(e){var t=1;if(e.length<1)return this.categoryFetchError=!0,this.trigger("categoryFetchError"),e;for(t;t<e.length;t++)e[t].position=t;return e},setCurrentCategoryOnSync:function(){this.setCurrentCategory(this.currentCategoryId)},setCurrentLeaf:function(e){if(this.activeLeaf===null){this.setLeafAsActive(e);return}this.activeLeaf.set("active",!1),this.setLeafAsActive(e)},setLeafAsActive:function(e){this.activeLeaf=e,this.activeLeaf.set("active",!0)},setCurrentCategory:function(e){this.currentCategoryId=parseInt(e,10);var t=this.findWhere({categoryId:this.currentCategoryId}),n=this.where({parentId:this.currentCategoryId});if(t===undefined){if(this.categoryFetchError){this.categoryFetchError=!1;return}this.fetchCurrentCategory();return}if(n.length<1){if(!t.get("leaf")){this.fetchCurrentCategory();return}this.setCurrentLeaf(t),this.setCurrentCategory(t.get("parentId"));return}this.currentCategory=t,this.currentCategorySubCategories=n,this.trigger("currentCategorySet")}})}),define("navigation/collections/DepartmentsCollection",["backbone"],function(e){return e.Collection.extend({url:"",currentDepartment:null,currentDepartmentName:null,inSync:!1,initialize:function(e){this.url=e.url,this.listenTo(this,"sync",this.setCacheFlag)},setCacheFlag:function(){this.inSync=!0},isDepartmentsListInCache:function(){return this.inSync},getDepartmentsList:function(){this.fetch()},setCurrentDepartmentAsync:function(){this.setCurrentDepartment(this.currentDepartmentName)},setCurrentDepartment:function(e){if(!this.isDepartmentsListInCache()){this.currentDepartmentName=e,this.listenTo(this,"sync",this.setCurrentDepartmentAsync),this.getDepartmentsList();return}this.currentDepartment=this.findWhere({name:e}),this.trigger("currentDepartmentSet")},setDepartmentByCategoryIdAsync:function(){this.setDepartmentByCategoryId(this.departmentCategoryId)},setDepartmentByCategoryId:function(e){var t,n;if(!this.isDepartmentsListInCache()){this.departmentCategoryId=e,this.listenTo(this,"sync",this.setDepartmentByCategoryIdAsync),this.getDepartmentsList();return}for(n=0;n<this.length;n++){var r=this.at(n),i=r.get("categories");for(t=0;t<i.length;t++)if(i[t].categoryId===e){this.currentDepartment=r,this.trigger("currentDepartmentSet");return}}}})}),define("navigation/views/SideNavigationToggleView",["backbone","underscore","navigation/views/NavigationAbstractView"],function(e,t,n){var r=n.extend({active:!1,events:{click:"setSideNavVisibility"},initialize:function(e){this.dispatcher=e.dispatcher,this.uniqueCMId=e.uniqueCMId,this.isToggleVisible(),this.listenTo(this.dispatcher,"toggleSideNavVisibility",this.toggleSideNavClass)},isToggleVisible:function(){typeof window.matchMedia!="undefined"&&window.matchMedia("(max-width: 920px)").matches&&this.sendEventForCookieMonster(this.uniqueCMId,"SideNavigation","toggle_visible")},toggleSideNavClass:function(){this.$el.toggleClass("active")},setSideNavVisibility:function(){this.active=this.active?!1:!0,this.sendEventForCookieMonster(this.uniqueCMId,"SideNavigation","toggle_click",this.active),this.toggleSideNavClass(),this.dispatcher.trigger("setSideNavVisibility")}});return r}),define("navigation/main",["backbone","jquery","underscore","navigation/views/SideNavigationView","navigation/collections/CategoriesCollection","navigation/collections/DepartmentsCollection","navigation/views/SideNavigationToggleView"],function(e,t,n,r,i,s,o){return function(e){var n,u,a,f,l=t(".main-header-wrapper"),c=t(".user-links-wrapper").clone(),h=c.find(".user-nav"),p=parseInt((1+Math.random())*16777216,10);a=new i({baseUrl:h.data("categoryListRoute")}),f=new s({url:h.data("departmentsListRoute")}),n=new r({el:".side-nav",userNavigation:c,dispatcher:e.dispatcher,headerType:l.data("headerType"),enableCategoriesNavigation:h.data("enableCategoriesNavigation"),categoriesCollection:a,departmentsCollection:f,uniqueCMId:p}),u=new o({el:".navigation-toggle",dispatcher:e.dispatcher,uniqueCMId:p})}}),define("splashscreen/mobile-splash/MobileSplashView",["jquery","backbone","jquery.cookie"],function(e,t){var n=t.View.extend({deviceData:{},deviceName:"",eventCat:"mobileSplash",events:{"click .close":"closeSplash","click .button, .smartphone":"downloadApp","click .footer a":"watchVideo"},initialize:function(e){this.template=e.template,this.devicesData=this.$el.data("devices")},show:function(){if(e.cookie("mobileSplash"))return;e.cookie("mobileSplash",1,{expires:7,path:"/"}),this.detectDevice();if(this.deviceName==="")return;this.render()},downloadApp:function(){this.sendEventForCookieMonster("downloadApp")},watchVideo:function(){this.sendEventForCookieMonster("watchVideo")},sendEventForCookieMonster:function(e){var t={cat:this.eventCat,a:e};try{window.cm.event(t)}catch(n){window.console.info("Fail to log cookie monster "+t.cat+" event.")}},detectDevice:function(){/Android/i.test(navigator.userAgent)?(this.deviceData=this.devicesData.android,this.deviceName="android"):/IEMobile/i.test(navigator.userAgent)?(this.deviceData=this.devicesData.windows,this.deviceName="windows"):/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(this.deviceData=this.devicesData.apple,this.deviceName="apple"),this.deviceData.smartphoneImg=this.$el.data(this.deviceName)},closeSplash:function(){this.$el.addClass("hidden"),this.sendEventForCookieMonster("close")},render:function(){return this.$el.html(this.template(this.deviceData)),this.$el.removeClass("hidden"),this}});return n}),define("splashscreen/main",["splashscreen/mobile-splash/MobileSplashView","jquery","underscore"],function(e,t,n){return function(){var r,i=t(".mobile-splash-container");i.length&&(r=new e({el:i,template:n.template(t("#mobile-splash-template").html())}),r.show())}}),function(e,t){typeof define=="function"&&define.amd?define("cookies-interface-js",[],function(){return e.cookiesInterface=t()}):e.cookiesInterface=t()}(this,function(){var e=function(){};return e.prototype.set=function(e,t,n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="expires="+r.toUTCString();document.cookie=e+"="+t+"; "+i},e.prototype.get=function(e){var t=e+"=",n=document.cookie;n=n.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)===" ")i=i.substring(1);if(i.indexOf(t)!==-1)return this.parse(i.substring(t.length,i.length))}return""},e.prototype.parse=function(e){var t=/\+/g;e.indexOf('"')===0&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return decodeURIComponent(e.replace(t," "))}catch(n){}},e}),function(e,t){typeof define=="function"&&define.amd?define("splashscreen/InstallmentsBanner",["cookies-interface-js"],function(n){return e.installmentsBanner=t(n)}):e.installmentsBanner=t(window.cookiesInterface)}(this,function(e){function n(e,t){if(typeof e!="function")return;return function(){return e.apply(t,arguments)}}var t=new e,r=function(t){this.options=t,this.baseElement=document.getElementById(this.options.baseElementId),this.closeElement=document.getElementById(this.options.closeElementId),this.storageName="installmentsBannerHide",this.expireDate=this.options.expireDate?this.options.expireDate:365,this.render()};return r.prototype.render=function(){if(t.get(this.storageName))return;this.baseElement.className="enabled",this.attachListeners()},r.prototype.hideBanner=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,this.baseElement.className="",t.set(this.storageName,1,this.expireDate)},r.prototype.attachListeners=function(){if(document.addEventListener){this.closeElement.addEventListener("click",n(this.hideBanner,this),!1);return}this.closeElement.attachEvent("onclick",n(this.hideBanner,this))},r}),define("velalayout/pagesMain",["velalayout/openHelp","search/app","departments/navigationBar/main","velalayout/GetUserLoginData","velalayout/cartStatus/main","velalayout/login-tip","cookiepolicy/main","navigation/main","splashscreen/main","splashscreen/InstallmentsBanner","json","jquery","backbone","underscore","jquery.cookie"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){return function(l){l===undefined&&(l={});var d=p.defaults(l,{dispatcher:p.clone(h.Events)}),v=new r;v.initialize(),e.initialize();var m=new u({dispatcher:d.dispatcher}),g=new t({dispatcher:d.dispatcher}),y=c(".main-header + .main-nav"),b;y.length&&(b=new n({el:".main-header + .main-nav",urlRoot:y.data("url-root"),openLayerDelay:300,closeLayerDelay:400})),c("#cart-status-wrapper").length&&i.initialize({el:"#cart-status-wrapper",previewUrl:"/Cart.php/getCartDataJson",addUrl:"/Cart.php/addAjax"}),s();var w=c("#cookie-policy-banner-config").data("config"),E;w&&(E=new o({storageName:"policyBannerHide",policyPageUrl:w.url,langs:w.langs})),a();if(c("#installments-banner-container").length)var S=new f({baseElementId:"installments-banner-container",closeElementId:"installments-banner-close"})}});